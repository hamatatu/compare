<p>1〜10行目
この関数で使う定数・変数を定義しています。

12〜17行目
UAによりデバイス判定を行い、変数「device」に結果を格納しています。

19〜30行目
「device」によりイベントハンドラの種類をそれぞれ変数に格納しています。
ここでイベントハンドラを変数に格納して、デバイスにより変数の中身を変えることで、スマホでのタッチイベントに対応させることができています。

32〜64行目
マウスを押した時または、タッチをした時に実行させる「dragStart」関数についての記述です。

34〜39行目
タッチイベントでは複数の指によるタッチイベントも取得可能です。そこでタッチイベントで座標を取得する際は「event.changedTouches[0].pageX」といった形で取得する必要があります。
座標を取得する度に「event.pageX」と「event.changedTouches[0].pageX」を書き分けるの面倒なので、スマホ時は「event = event.changedTouches[0]」にしています。

41〜43行目
ここで「move_flg」をtrueにします。これでdragMove関数が動くようになります。

45〜61行目
スマホユーザーのユーザビリティを向上ために、スマホ時は境界線をタッチするのでなく、全体を囲んでいる要素「comparison-block」をタッチしてスライドさせれば、境界線が動くようになっています。ですので、境界線要素（arrow要素）の取得方法がPC/スマホで異なります。そのためif文により振り分けています。

62〜63行目
dragStart関数が発火した全体を囲む要素（comparison-block ※以下「COMPARISON_BLOCK要素」）をdragMove関数に渡す必要があります。この要素を渡すことでイベントが発火した要素を確定でき、同一ページに複数されても独立して動くようになります。
また、一度dragMove関数をグローバル変数のdragMoveFuncに格納することで、dragMove関数を解除できるようにして、かつ、dragMove関数に変数を渡せるようにしています。
これに関しては、addEventListenerで関数に引数を渡すを参考にさせていただきました。

66〜105行目
今回の肝となるdragMove関数についての記述です。

68〜73行目
「34〜39行目」と同じです。

75行目
「41〜43行目」で説明した「move_flg」がtrueの場合のみ、境界線を動かします。

80〜90行目
COMPARISON_BLOCK要素の子要素の「.comparison-before-img」要素（※以下「BEFORE_IMG要素」）を取得しています。

91〜92行目
「X」は境界線のx座標から、COMPARISON_BLOCK要素のx座標を引いた値です。
「maxX」は境界線のx座標の移動値の最大値です。「maxX」はCOMPARISON_BLOCK要素の幅を取得しています。

93〜103行目
境界線がCOMPARISON_BLOCK要素を出ないように、境界線のx座標に下限、上限を決めています。
また画像の表示に関しては、「.comparison-after-img」要素（※以下「AFTER_IMG要素」）の上にposition:absolute;でBEFORE_IMG要素を乗せていて、overfloe:hidden;を設定しているBEFORE_IMG要素の幅を境界線の相対的なx値に合わせることで、下のAFTER_IMG要素が見えるようにしています。
以下にイメージを添付していますので、参考にしてみてください。

構造イメージ
構造のイメージ
107〜112行目
dragEnd関数の記述です。「move_flg」をfalseにして、「dragMoveFunc」を解除しています。
これにより、COMPARISON_BLOCK要素以外の場所でマウスムーブや、タッチムーブをしても境界線要素は動きません。

114〜123行目
ロード時の関数の記述です。BEFORE_IMG要素のwidthをCOMPARISON_BLOCK要素のwidthの半分にして、BEFORE_IMG要素の画像はCOMPARISON_BLOCK要素のwidthに合わせています。

125〜136行目
リサイズ時の関数の記述です。リサイズすると、ロード時の関数と同じ処理＋境界線要素（arrow要素）をCOMPARISON_BLOCK要素の真ん中に持ってくる処理も行っています。

139〜152行目
関数の実行です。「45〜61行目」の時に説明したように、デバイスによりdragStart関数が発火する要素が違います。

</p>
